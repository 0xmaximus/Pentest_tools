import argparse
from urllib.parse import urlparse, parse_qs, urlencode, urlunparse

def fuzz_urls(input_file, output_file, word_replace):
    with open(input_file, 'r') as f:
        urls = f.readlines()

    modified_urls = []
    for url in urls:
        url = url.strip()
        parsed_url = urlparse(url)
        path_parts = parsed_url.path.split('/')
        for i, part in enumerate(path_parts):
            if part != '':
                path_parts[i] = 'FUZZ'
                modified_path = '/'.join(path_parts)
                modified_url = urlunparse(parsed_url._replace(path=modified_path))
                modified_urls.append(modified_url)
                path_parts = parsed_url.path.split('/') 
                
    for url in urls:
        url = url.strip()
        parsed_url = urlparse(url)
        query_parts = parsed_url.query.split('=')
        for i, part in enumerate(query_parts):
            if part != '':
                query_parts[i] = 'FUZZ'
                modified_path = '='.join(query_parts)
                modified_url = urlunparse(parsed_url._replace(query=modified_path))
                modified_urls.append(modified_url)
                query_parts = parsed_url.query.split('=')
                
    
    with open(output_file, 'w') as f:
        f.write('\n'.join(modified_urls))
        
        
    with open(output_file, 'r') as f:
        urls = f.readlines()    
        
    def replace_fuzz_with_custom_word(url):
        return url.replace('FUZZ', word_replace)
    
    modified_urls = []
    for url in urls:
        modified_urls.append(replace_fuzz_with_custom_word(url.strip()))
        
    with open(output_file, 'w') as f:
        f.write('\n'.join(modified_urls))

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('-l', '--input_file', help='Input file containing URLs')
    parser.add_argument('-o', '--output_file', help='Output file to save modified URLs')
    parser.add_argument('-w', '--word_replace', help='replace to save modified URLs', default='ghannary%3c%22')
    args = parser.parse_args()

    fuzz_urls(args.input_file, args.output_file , args.word_replace)
